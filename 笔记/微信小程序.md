# 微信开发 - 小程序

## 开发原则
- 使用less进行css编写，最外面使用和组件同名的 className 防止样式被冲掉；
- 组件化封装的原则；

## 创建动画 -- wx.createAnimation()
- [微信小程序把玩系列](https://blog.csdn.net/u014360817/article/details/52712205)
```javascript
onShow() {
  var animation = wx.createAnimation({
    transformOrigin: "50% 50%",
    duration: 200,
    timingFunction: "linear",
    delay: 0
  })
  this.animation = animation;
}
```

## navigateTo与redirectTo区别 
- 前者表示不破坏当前页序，在当前页面进行跳转； 
- 后者 打开一个新的webview 并关闭之前的页面；（到时看下这种情况是不是没有返回按钮）

## bindtap和catchtap
- bind事件绑定不会阻止冒泡事件向上冒泡
- catch事件绑定可以阻止冒泡事件向上冒泡

## 页面滑动到指定位置
```javascript
wx.pageScrollTo({
  scrollTop: 0,
  duration: 300
})
```

## 加载更多
```javascript 
onReachBottom() {
  console.log("加载更多");
  let that = this;
  that.showLoading = true;
  // 函数截流标记

}
```

## wepy框架
- 向上 向下查找组件，可以在任何层级的组件，引用到任何其他位置的组件
  - 比如：let com = this.$root.$com.index.$com.search;
  - this.$invoke(com, 'RemindToShow'); 
- 向上 向下 events里提供的事件，
  - 如何使子组件角色，父组件可以 this.$boadcast('eventName')
  - 如何是父组件角色，子组件可以 this.$emit('eventName)

## wepy 组件demo  
```html 
<template>
  <!--index.wxml-->
  <view class="swiper-tab">
    <view wx:for="{{tabList}}" wx:key="index" class="swiper-tab-list {{currentTab==index ? 'active' : ''}}" data-current="{{index}}" bindtap="swichNav">
      {{item.name? item.name:item}}
      <view class=" {{item.dotNum>=100?'dotbig':'dot'}}" wx:if="{{item.dotNum>0}}">{{item.dotNum}}</view>
    </view>
  </view>
</template>
<script>
import wepy from 'wepy'

export default class Filter extends wepy.component {
  // props的运用
  props = {
    currentTab: {
      default: 0
    },
    tabList: {
      type: Object
    }
  }

  methods = {
    /**
     * 点击tab切换
     */
    swichNav(e) {
      let that = this;
      if (this.data.currentTab == e.target.dataset.current) {
        return false;
      } else {
        that.currentTab = e.target.dataset.current;
        that.$apply();
      }
      this.$emit("currentTab", that.currentTab)
    },
    /**
     * 头部红点标识
     * @param  {[type]} dotList [description]
     * @return {[type]}         [description]
     */
    changeList(dotList) {
      this.tabList = dotList;
    }
  }


  onLoad() {
    let that = this;

  }
  watch = {
    currentTab(newValue, oldValue) {
      console.log(`currentTab value: ${oldValue} -> ${newValue}`)
    }
  }
}

</script>
    <!-- 注意这里监听事件的方式，修饰的方式，传递props的方式 -->
    <!-- page中调用 tab模块-->
    <view class="tab_box">
      <tab @currentTab.user="getCurrentTab" :currentTab.sync="currentTab" :tabList.sync="tabList"></tab>
    </view>
```

## wxs文件
```javascript
// mywxs.wxs

module.exports = {
  text: 'This is from wxs',
  filter: function(num) {
    return num.toFixed(2);
  }
}
// 注意：
- 感觉这个玩意是，全局的过滤器可以使用
- wxs必须是外链文件，并且后缀为 .wxs
- wxs引入后只能在template中使用，不能再script中使用

// 拦截器功能，其实就是所有请求的前置 后置钩子
```

```javascript
import wepy from 'wepy';
export default class MyAPP extends wepy.app {
  customData = {}
  customFunc() {}
  onLaunch() {}
  onShow() {}
  config = {} // 对应app.json
  globalData = {}
}
// 在Page页面实例中，可以通过this.$parent来访问App实例
```

## 体验小程序

- [体验小程序](https://mp.weixin.qq.com/debug/wxadoc/dev/demo.html)
![img](./images/demo.jpg)

## 小程序文档与配置后台
- [配置地址](https://mp.weixin.qq.com/)
- [文档地址](https://developers.weixin.qq.com/miniprogram/dev/index.html)
## 官方IDE
![img](./images/demo03.jpg)
## 组件和API区别
![img](./images/demo02.jpg)
- react native的文档对比
- 组件是构成UI的单元
- API 一般是wx对象的方法
  - 调用网络
  - 调用媒体播放暂停
  - 调用地理位置等
##　小程序的生命周期
- 主要是： 
  - app实例的生命周期
  - page 页面的生命周期
  - 组件生命周期
## 布局的局限性
- 头部 
## 组件 （智能组件和木偶组件）
- 木偶组件 在小程序中是由template这种方式实现的

## 受控组件
- 事件绑定的方式

## 对es6的支持
- [支持语法](https://www.cnblogs.com/oopsguy/p/6072462.html)

## 布局单位
- 利用类似rem的思想 实现适配
- 默认宽度是750rpx 设计稿最好是750px的宽来设计
## 对webview的支持
- 2017年底开始支持 个人开发者账号不支持
- [webview文档地址](https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html)
## 打包后大小的限制
- 之前是1M现在是2M，所以很多图片等资源都需要放到服务端

## 编程难点
- [登录逻辑](https://developers.weixin.qq.com/miniprogram/dev/api/api-login.html)
![img](./images/api-login.jpg)
- wx.setStorageSync(key, data)[数据存储](https://developers.weixin.qq.com/miniprogram/dev/api/data.html#wxsetstoragesynckeydata)
- 一些前端的 自定义效果

## 结合项目代码演示
- [商城git地址](git@github.com:EastWorld/wechat-app-mall.git)


